# 测试结果弹窗功能设计文档

## 功能概述

当用户点击"测试"按钮后,系统会显示一个详细的测试结果弹窗,展示采集到的文章列表,方便用户核对采集质量。

## 设计特点

### 1. **视觉层次清晰**
- 使用绿色/红色背景区分成功/失败状态
- 文章卡片采用悬停阴影效果
- 圆形序号标识清晰

### 2. **信息完整**
- ✅ 测试状态(成功/失败)
- 📊 采集文章数量
- 🔍 测试日志(显示尝试过程)
- 📰 文章列表(最多显示10篇)

### 3. **文章卡片展示**
每篇文章包含:
- **序号**: 蓝色圆形标识(1-10)
- **标题**: 粗体显示,最多2行,超出显示省略号
- **描述**: 灰色小字,最多2行(如果有)
- **链接**: 可点击跳转,蓝色下划线
- **发布日期**: 日期格式化显示(如果有)
- **缩略图**: 右侧显示(如果有),加载失败自动隐藏

### 4. **交互优化**
- 文章链接可以在新标签页打开
- 图片加载失败自动隐藏
- 弹窗可滚动查看所有内容
- 超过10篇文章会显示"还有 X 篇未显示"

### 5. **成功状态布局**
```
┌─────────────────────────────────────┐
│ 📊 测试结果: 信息源名称           × │
├─────────────────────────────────────┤
│ ✅ 测试成功                         │
│    成功采集 10 篇文章               │
│                                     │
│ 🔍 测试日志                         │
│   尝试 RSS 采集...                  │
│   ✓ RSS 采集成功                    │
│                                     │
│ 📰 采集到的文章 (显示前 10 篇)      │
│                                     │
│ [1] 文章标题                        │
│     文章描述...                     │
│     🔗 链接  📅 日期         [图片] │
│                                     │
│ [2] 文章标题                        │
│     ...                             │
│                                     │
│ 还有 5 篇文章未显示                 │
├─────────────────────────────────────┤
│              [关闭] [确认无误,返回激活] │
└─────────────────────────────────────┘
```

### 6. **失败状态布局**
```
┌─────────────────────────────────────┐
│ 📊 测试结果: 信息源名称           × │
├─────────────────────────────────────┤
│ ❌ 测试失败                         │
│    错误信息                         │
│                                     │
│ 测试日志:                           │
│   尝试 RSS 采集...                  │
│   RSS 采集失败: xxx                 │
│   自动降级到网页爬虫...             │
│   ✗ 网页爬虫也失败: xxx             │
│                                     │
│ 💡 建议: 请检查 URL...              │
├─────────────────────────────────────┤
│                          [关闭]     │
└─────────────────────────────────────┘
```

## 技术实现

### 状态管理
```typescript
const [testResultModal, setTestResultModal] = useState<{
  show: boolean
  sourceName: string
  result: any
}>({
  show: false,
  sourceName: '',
  result: null
})
```

### API数据结构
```typescript
{
  success: true,
  testResult: {
    success: true,
    count: 10,
    attemptLog: [
      "尝试 RSS 采集...",
      "✓ RSS 采集成功"
    ],
    articles: [
      {
        title: "文章标题",
        description: "文章描述",
        link: "https://...",
        pubDate: "2025-10-09T00:00:00.000Z",
        imageUrl: "https://..."
      }
    ]
  }
}
```

## 样式预览

已创建静态HTML预览文件: `/tmp/test-modal-preview.html`

在浏览器中打开可查看完整样式效果。

## 用户体验流程

1. **点击测试按钮**
   - 按钮显示"测试中..."
   - 禁用按钮避免重复点击

2. **测试完成**
   - 自动弹出结果弹窗
   - 显示采集到的文章列表

3. **核对文章**
   - 查看文章标题是否正确
   - 点击链接跳转到原文验证
   - 检查图片是否正常

4. **确认无误**
   - 点击"确认无误,返回激活"
   - 关闭弹窗,返回列表
   - 可以点击"激活"按钮

## 移动端适配

- 弹窗最大高度: 90vh
- 内容区域可滚动
- 在小屏幕上自动调整布局
- 图片在移动端可能隐藏

## 后续优化建议

1. **快捷激活**: 在弹窗底部直接提供"激活"按钮
2. **文章预览**: 点击文章卡片展开查看完整内容
3. **导出功能**: 导出测试结果为JSON/CSV
4. **对比功能**: 对比不同测试的结果
5. **保存记录**: 保存历史测试结果

---

**设计完成日期**: 2025-10-09
**状态**: ✅ 样式已完成,等待确认后连接真实数据
