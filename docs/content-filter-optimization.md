# 内容过滤提示词优化记录

## 优化日期
2025-10-11

## 问题描述

发现 AI 内容过滤器将一些传统行业的文章误判为科技相关内容，例如：
- ❌ "我国自主研发气象早期预警系统'妈祖(MAZU)'已在多国应用" → 被保留
- ❌ "吉电股份：绿色氢基能源产业是公司发展布局的双赛道之一" → 被保留
- ❌ "我国灾害性天气监测率提升至83%" → 被保留

## 根因分析

原提示词存在以下问题：

### 1. "自然科学研究" 标准过于宽泛
```
- 自然科学研究  ← 问题：气象学也属于自然科学
```
这导致所有自然科学相关的内容都被保留，包括气象、地质、天文等传统领域。

### 2. "科技产品" 定义不明确
```
- 科技产品报道  ← 问题：没有明确什么是"科技产品"
```
导致气象预警系统、能源设备等也被视为"科技产品"。

### 3. 缺少传统行业的明确排除规则
原提示词没有明确排除传统行业的应用场景。

## 优化方案

### 改进 1: 移除宽泛的"自然科学研究"
**修改前：**
```
- 自然科学研究
```

**修改后：**
```
- 计算机科学、密码学、网络安全研究
```
明确限定为与计算机/互联网相关的科学研究。

### 改进 2: 明确"科技产品"的范围
**修改前：**
```
- 科技产品报道（即使提到价格、销售，只要主题是科技产品就保留）
```

**修改后：**
```
- 消费电子产品（手机、电脑、可穿戴设备、智能家居等）
- 芯片、半导体、硬件技术
```
明确限定为消费电子和硬件技术领域。

### 改进 3: 新增"传统行业应用"到删除标准
```
**删除标准：**
- 传统行业应用（气象、能源、交通运输、建筑等，除非涉及AI/互联网技术突破）
- 医疗健康、生物制药（除非涉及AI医疗、生物计算）
- 传统金融、房地产、保险业务
```

### 改进 4: 添加判断示例
```
**判断技巧：**
- ✅ "OpenAI发布GPT-5" → AI公司产品，保留
- ✅ "特斯拉自动驾驶更新" → 科技产品，保留
- ✅ "字节跳动投资AI芯片公司" → 科技投资，保留
- ❌ "气象预警系统在多国应用" → 传统气象行业，删除
- ❌ "氢能源产业发展布局" → 传统能源行业，删除
- ❌ "灾害性天气监测率提升" → 气象数据，删除
```

## 验证结果

使用新提示词重新测试问题文章：

| 文章标题 | 旧提示词 | 新提示词 | 结果 |
|---------|---------|---------|------|
| 气象早期预警系统"妈祖(MAZU)" | ✅ 保留 | ❌ 过滤 | ✅ 正确 |
| 北斗探空系统 | ✅ 保留 | ❌ 过滤 | ✅ 正确 |
| 氢基能源产业 | ✅ 保留 | ❌ 过滤 | ✅ 正确 |
| 灾害性天气监测率 | ✅ 保留 | ❌ 过滤 | ✅ 正确 |
| 气象服务覆盖行业 | ✅ 保留 | ❌ 过滤 | ✅ 正确 |
| 生成式人工智能服务 | ✅ 保留 | ✅ 保留 | ✅ 正确 |
| 滴滴低空科技公司 | ✅ 保留 | ✅ 保留 | ✅ 正确 |

## 影响范围

- ✅ 更精准地聚焦在 AI/互联网/消费科技领域
- ✅ 有效过滤传统行业的非技术性新闻
- ✅ 保持对真正科技创新的敏感度
- ⚠️ 可能过滤掉传统行业中的重大技术突破（需人工审核边界案例）

## 后续优化方向

1. **A/B 测试**: 对比新旧提示词的过滤效果，收集更多数据
2. **边界案例库**: 建立边界案例数据库，持续优化判断标准
3. **用户反馈**: 收集用户对过滤结果的反馈，调整权重
4. **多模型对比**: 尝试不同 LLM 的过滤效果对比

## 实施方式

提示词配置存储在数据库的 `PromptConfig` 表中，通过以下方式更新：

```typescript
await prisma.promptConfig.update({
  where: { key: 'content_filter' },
  data: {
    userPromptTemplate: newUserPrompt,
    version: { increment: 1 }
  }
})
```

更新后立即生效，无需重启服务。
