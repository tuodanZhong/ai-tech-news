# 翻译功能优化总结

## 优化目标
将原有的采集时自动翻译改为按需翻译,提升采集速度,优化用户体验。

## 实现方案

### 1. 数据库结构调整
- 在 `Article` 模型中添加 `isTranslated` 字段(Boolean类型)
- 默认值为 `false`,标识文章是否已翻译
- 添加索引以优化查询性能

### 2. 采集逻辑优化
- 修改 `lib/rss-parser.ts` 中的 `fetchRSSFeed` 函数
- 采集时直接保存原文,不进行翻译
- 将 `title`、`description`、`content` 字段暂存原文内容
- 设置 `isTranslated` 为 `false`

### 3. 翻译API接口
创建新的翻译接口 `/api/translate`:
- 接收 `page` 和 `limit` 参数
- 查询当前页所有未翻译的文章
- 逐个进行翻译(检测是否中文,避免重复翻译)
- 更新文章的翻译内容并标记为已翻译
- 返回翻译结果统计

### 4. 前端UI优化
在首页 (`app/page.tsx`) 添加:
- **翻译按钮**: 位于页面顶部,带有翻译图标
- **翻译状态显示**: 显示翻译进度和结果
- **未翻译标识**: 在文章卡片上显示"未翻译"标签
- **翻译功能**: 点击按钮翻译当前页面的所有未翻译文章

## 使用方式

### 采集文章
1. 点击页面右上角的"采集新闻"按钮
2. 系统自动采集所有RSS源的文章(不翻译)
3. 采集完成后显示采集数量

### 翻译文章
1. 在任意页面点击"翻译本页"按钮
2. 系统自动翻译当前页面的所有未翻译文章
3. 翻译完成后刷新页面显示翻译结果
4. 已翻译的文章会保存到数据库,下次直接读取

## 优势

1. **速度提升**: 采集不再需要等待翻译,速度大幅提升
2. **按需翻译**: 只翻译用户需要看的内容,节省资源
3. **持久化存储**: 翻译结果保存在数据库,避免重复翻译
4. **状态标识**: 清晰显示文章翻译状态,用户体验更好
5. **灵活控制**: 用户可以选择何时翻译,更加灵活

## 技术栈
- Next.js 15.5.4
- Prisma (SQLite)
- @xenova/transformers (本地翻译模型)
- TypeScript
- Tailwind CSS
